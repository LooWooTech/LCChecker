@using LCChecker.Models
@{
    Layout = "_Layout.cshtml";
    ViewBag.Title = "统计概况";
    Dictionary<City, Summary> projectSummary = ViewBag.ProjectSummary;
    Dictionary<City, Summary> reportSummary = ViewBag.ReportSummary;
    Dictionary<City, Summary> coordSummary = ViewBag.CoordSummary;
}

<ul class="nav nav-tabs">
    <li class="active"><a href="#tab1" data-toggle="tab">自检表统计</a></li>
    <li class=""><a href="#tab2" data-toggle="tab">报部表统计</a></li>
    <li class=""><a href="#tab3" data-toggle="tab">坐标点存疑统计</a></li>
   
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="tab1">
        <p>@Html.ActionLink("下载统计表格", "DownLoadExcel", "Admin", new { id=1}, new { @class="btn btn-sm btn-primary",target="_blank"}) @Html.ActionLink("自检表汇总", "DownloadSummary", "Admin", new { }, new { @class="btn btn-sm btn-primary",target="_blank"})</p>
        <table class="table table-bordered">
            <tr>
                <th>市</th>
                <th>项目总数</th>
                <th>通过总数</th>
                <th>失败总数</th>
                <th>未上传数</th>
            </tr>
            @foreach (var kv in projectSummary)
            {
                var summary = kv.Value;
                <tr>
                    <td><a href="/admin/projects?city=@((int)summary.City)">@(summary.City)</a></td>
                    <td>@(summary.TotalCount)</td>
                    <td>@(summary.SuccessCount)</td>
                    <td>@(summary.ErrorCount)</td>
                    <td>@(summary.UnCheckCount)</td>
                </tr>
            }
        </table>
    </div>
    <div class="tab-pane fade" id="tab2">
        <p>@Html.ActionLink("下载统计表格", "DownLoadExcel", "Admin", new { id=2}, new { @class="btn btn-sm btn-primary",target="_blank"}) @Html.ActionLink("附表4汇总", "DownloadSummaryReport", "Admin", new {type=ReportType.附表4 }, new { @class="btn btn-sm btn-primary",target="_blank"}) @Html.ActionLink("附表5汇总", "DownloadSummaryReport", "Admin", new { type=ReportType.附表5}, new {@class="btn btn-sm btn-primary",target="_blank" })  @Html.ActionLink("附表7汇总", "DownloadSummaryReport", "Admin", new { type=ReportType.附表7}, new {@class="btn btn-sm btn-primary",target="_blank" }) @Html.ActionLink("附表8汇总", "DownloadSummaryReport", "Admin", new {type=ReportType.附表8 }, new {@class="btn btn-sm btn-primary",target="_blank" }) @Html.ActionLink("附表9汇总", "DownloadSummaryReport", "Admin", new { type=ReportType.附表9}, new {@class="btn btn-sm btn-primary",target="_blank" })</p>
        <table class="table table-bordered">
            <tr>
                <th>市</th>
                <th>项目总数</th>
                <th>通过总数</th>
                <th>失败总数</th>
                <th>未上传数</th>
            </tr>
            @foreach (var kv in reportSummary)
            {
                var summary = kv.Value;
                <tr>
                    <td><a href="/admin/reports?city=@((int)summary.City)">@(summary.City)</a></td>
                    <td>@(summary.TotalCount)</td>
                    <td>@(summary.SuccessCount)</td>
                    <td>@(summary.ErrorCount)</td>
                    <td>@(summary.UnCheckCount)</td>
                </tr>
            }
        </table>
    </div>
    <div class="tab-pane fade" id="tab3">
        <p>@Html.ActionLink("下载统计表格", "DownLoadExcel", "Admin", new { id=3}, new { @class="btn btn-sm btn-primary",target="_blank"})</p>
        <table class="table table-bordered">
            <tr>
                <th>市</th>
                <th>项目总数</th>
                <th>通过总数</th>
                <th>失败总数</th>
                <th>未上传数</th>
            </tr>
            @foreach (var kv in coordSummary)
            {
                var summary = kv.Value;
                <tr>
                    <td><a href="/admin/coordprojects?city=@((int)summary.City)">@(summary.City)</a></td>
                    <td>@(summary.TotalCount)</td>
                    <td>@(summary.SuccessCount)</td>
                    <td>@(summary.ErrorCount)</td>
                    <td>@(summary.UnCheckCount)</td>
                </tr>
            }
        </table>
    </div>
</div>
